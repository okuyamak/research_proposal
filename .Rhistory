library(dagitty)
install.packages("dagitty")
library(ggdag)
install.packages("ggdag")
library(dagitty)
library(ggdag)
dag <- dagitty("dag{y <- z -> x}")
ggdag(dag, layout = "circle")
opts_chunk$set(echo=F,message=F,warning=F)
dag1 <- ggdag(dag, layout = "circle")
ggsave(graph/dag1.png)
ggsave("graph/dag1.png")
library(dagitty)
library(ggdag)
install.packages("ggdag")
print(dag1)
library(dagitty)
library(ggdag)
dag <- dagitty("dag{y <- z -> x}")
dag1 <- ggdag(dag, layout = "circle")
print(dag1)
dag
print(dag)
dag1 <- ggdag(dag, layout = "square")
dag1 <- ggdag(dag, layout = "circle")
### practice
dagify(y ~ x) %>%
ggdag()
### practice
dagify(y ~~ x) %>%
ggdag()
### practice
dagify(y ~~ x) %>%
ggdag_canonical()
DAG(y ~ z, y ~ x + u + v,  u ~ v + z, order=TRUE)
### practice
obesity_dag <- dagify(obesity ~ pa + diet,
obesity ~ genetic,
obesity ~ age,
pa ~ pane
)
ggdag(obesity_dag)
### practice
obesity_dag <- dagify(obesity ~ pa + diet + genetic + age,
pa ~ pane
)
ggdag(obesity_dag)
### practice
obesity_dag <- dagify(obesity ~ pa + diet + genetic + age,
pa ~ pane + ses + genetic + deprivation,
)
### practice
obesity_dag <- dagify(obesity ~ pa + diet + genetic + age,
pa ~ pane + ses + genetic + deprivation
)
ggdag(obesity_dag)
### practice
obesity_dag <- dagify(obesity ~ pa + diet + genetic + age,
pa ~ pane + ses + genetic + deprivation,
diet ~ foodne + ses + genetic + deprivation
)
ggdag(obesity_dag)
### practice
obesity_dag <- dagify(obesity ~ pa + diet + genetic + age,
pa ~ pane + ses + genetic + deprivation,
diet ~ foodne + ses + genetic + deprivation
pane ~ ses,
foodne ~ ses)
### practice
obesity_dag <- dagify(obesity ~ pa + diet + genetic + age,
pa ~ pane + ses + genetic + deprivation,
diet ~ foodne + ses + genetic + deprivation
pane ~ ses,
foodne ~ ses
)
### practice
obesity_dag <- dagify(obesity ~ pa + diet + genetic + age,
pa ~ pane + ses + genetic + deprivation,
diet ~ foodne + ses + genetic + deprivation,
pane ~ ses,
foodne ~ ses
)
ggdag(obesity_dag)
### practice
obesity_dag <- dagify(obesity ~ pa + diet + genetic + age,
pa ~ pane + ses + genetic + deprivation + age,
diet ~ foodne + ses + genetic + deprivation + age,
pane ~ ses,
foodne ~ ses
)
ggdag(obesity_dag)
### practice
obesity_dag <- dagify(obesity ~ pa + diet + genetic + age,
pa ~ pane + ses + genetic + deprivation + age,
diet ~ foodne + ses + genetic + deprivation + age,
pane ~ ses,
foodne ~ ses,
labels = c("obesity" = "Obesity",
"pa" = "Physical activity",
"diet" = "Diet",
"genetic" = "Genetic risk",
"age" = "Age, gender, race",
"pane" = "PA environment",
"foodne" = "Food environment",
"ses" = "SES",
"deprivation" = "Neighborhood deprivation"),
exposure = "pane",
outcome = "obesity")
### practice
obesity_dag <- dagify(obesity ~ pa + diet + genetic + age,
pa ~ pane + ses + genetic + deprivation + age,
diet ~ foodne + ses + genetic + deprivation + age,
pane ~ ses,
foodne ~ ses,
labels = c("obesity" = "Obesity",
"pa" = "Physical activity",
"diet" = "Diet",
"genetic" = "Genetic risk",
"age" = "Age, gender, race",
"pane" = "PA environment",
"foodne" = "Food environment",
"ses" = "SES",
"deprivation" = "Neighborhood deprivation"),
exposure = "pane",
outcome = "obesity"
)
ggdag(obesity_dag, use_labels = "label")
ggdag(obesity_dag, text = FALSE, use_labels = "label")
### practice
obesity_dag <- dagify(obesity ~ pa + diet + genetic + age,
pa ~ pane + ses + genetic + deprivation + age,
diet ~ foodne + ses + genetic + deprivation + age,
pane ~ ses,
foodne ~ ses,
labels = c("obesity" = "Obesity",
"pa" = "Physical activity",
"diet" = "Diet",
"genetic" = "Genetic risk",
"age" = "Age, Sex",
"pane" = "PA environment",
"foodne" = "Food environment",
"ses" = "SES",
"deprivation" = "Neighborhood deprivation"),
exposure = "pane",
outcome = "obesity"
)
ggdag(obesity_dag, text = FALSE, use_labels = "label")
### practice
obesity_dag <- dagify(obesity ~ pa + diet + genetic + age,
pa ~ pane + ses + genetic + deprivation + age,
diet ~ foodne + ses + genetic + deprivation + age,
pane ~ ses,
foodne ~ ses,
labels = c("obesity" = "Obesity",
"pa" = "Physical activity",
"diet" = "Diet",
"genetic" = "Genetic risk",
"age" = "Age, Sex",
"pane" = "PA environment",
"foodne" = "Food environment",
"ses" = "SES",
"deprivation" = "Neighborhood deprivation"),
exposure = "pane",
outcome = "obesity"
)
ggdag(obesity_dag, text = FALSE, use_labels = "label")
### practice
obesity_dag <- dagify(obesity ~ pa + diet + genetic + age,
pa ~ pane + ses + genetic + deprivation + age,
diet ~ foodne + ses + genetic + deprivation + age,
pane ~ ses,
foodne ~ ses,
labels = c("obesity" = "Obesity",
"pa" = "Physical activity",
"diet" = "Diet",
"genetic" = "Genetic risk",
"age" = "Age, Sex",
"pane" = "PA environment",
"foodne" = "Food environment",
"ses" = "SES",
"deprivation" = "Neighborhood deprivation"),
exposure = "pane",
outcome = "obesity"
)
ggdag(obesity_dag, text = FALSE, use_labels = "label")
### practice
obesity_dag <- dagify(obesity ~ pa + diet + genetic + age,
pa ~ pane + ses + genetic + deprivation + age,
diet ~ foodne + ses + genetic + deprivation + age,
pane ~ ses,
foodne ~ ses,
labels = c("obesity" = "Obesity",
"pa" = "Physical activity",
"diet" = "Diet",
"genetic" = "Genetic risk",
"age" = "Age, Sex",
"pane" = "PA environment",
"foodne" = "Food environment",
"ses" = "SES",
"deprivation" = "Neighborhood deprivation"),
exposure = "pane",
outcome = "obesity"
)
ggdag(obesity_dag, text = FALSE, use_labels = "label")
ggdag(obesity_dag, text = FALSE, use_labels = "label")
ggdag(obesity_dag, text = FALSE, use_labels = "label")
ggdag_paths(obesity_dag, text = FALSE, use_labels = "label")
ggdag_adjustment_set(obesity_dag, text = FALSE, use_labels = "label")
ggdag_adjustment_set(obesity_dag, text = FALSE, use_labels = "label")
ggdag_adjustment_set(obesity_dag, text = FALSE, use_labels = "label")
### practice
obesity_dag <- dagify(obesity ~ pa + diet + genetic + age,
pa ~ pane + ses + genetic + deprivation + age,
diet ~ foodne + ses + genetic + deprivation + age,
pane ~ ses,
foodne ~ ses,
labels = c("obesity" = "Obesity",
"pa" = "Physical activity",
"diet" = "Diet",
"genetic" = "Genetic risk",
"age" = "Age, Sex",
"pane" = "PA environment",
"foodne" = "Food environment",
"ses" = "SES",
"deprivation" = "Neighborhood deprivation"),
exposure = "pane",
outcome = "obesity",
latent = "genetic"
)
ggdag(obesity_dag, text = FALSE, use_labels = "label")
ggdag_paths(obesity_dag, text = FALSE, use_labels = "label")
ggdag_adjustment_set(obesity_dag, text = FALSE, use_labels = "label")
### practice
obesity_dag <- dagify(obesity ~ pa + diet + genetic + age,
pa ~ pane + ses + genetic + deprivation + age,
diet ~ foodne + ses + genetic + deprivation + age,
pane ~ ses + age + deprivation,
foodne ~ ses,
labels = c("obesity" = "Obesity",
"pa" = "Physical activity",
"diet" = "Diet",
"genetic" = "Genetic risk",
"age" = "Age, Sex",
"pane" = "PA environment",
"foodne" = "Food environment",
"ses" = "SES",
"deprivation" = "Neighborhood deprivation"),
exposure = "pane",
outcome = "obesity",
latent = "genetic"
)
ggdag(obesity_dag, text = FALSE, use_labels = "label")
ggdag_paths(obesity_dag, text = FALSE, use_labels = "label")
ggdag_adjustment_set(obesity_dag, text = FALSE, use_labels = "label")
ggdag_adjustment_set(obesity_dag, text = FALSE, use_labels = "label")
ggdag_adjustment_set(obesity_dag, text = FALSE, use_labels = "label")
ggdag_adjustment_set(obesity_dag, text = FALSE, use_labels = "label")
ggdag_dseparated(obesity_dag, controlling_for = c("pa"),text = FALSE, use_labels = "label", collider_lines = TRUE)
ggdag_dseparated(obesity_dag, controlling_for = c("diet"),text = FALSE, use_labels = "label", collider_lines = TRUE)
ggdag_dseparated(obesity_dag, controlling_for = c("ses"),text = FALSE, use_labels = "label", collider_lines = TRUE)
ggdag_dseparated(obesity_dag, controlling_for = c("ses","genetic"),text = FALSE, use_labels = "label", collider_lines = TRUE)
ggdag_dseparated(obesity_dag, controlling_for = c("ses","genetic","age"),text = FALSE, use_labels = "label", collider_lines = TRUE)
ggdag_dseparated(obesity_dag, controlling_for = c("ses","genetic","age","pa"),text = FALSE, use_labels = "label", collider_lines = TRUE)
ggdag_adjustment_set(obesity_dag, text = FALSE, use_labels = "label")
ggdag_dseparated(obesity_dag, controlling_for = c("ses","genetic","age"),text = FALSE, use_labels = "label", collider_lines = TRUE)
ggdag_dseparated(obesity_dag, controlling_for = c("ses","age"),text = FALSE, use_labels = "label", collider_lines = TRUE)
### practice
obesity_dag <- dagify(obesity ~ pa + diet + genetic + age,
pa ~ pane + ses + genetic + deprivation + age,
diet ~ foodne + ses + genetic + deprivation + age,
pane ~ ses + age + deprivation,
foodne ~ ses,
labels = c("obesity" = "Obesity",
"pa" = "Physical activity",
"diet" = "Diet",
"genetic" = "Genetic risk",
"age" = "Age, Sex",
"pane" = "PA environment",
"foodne" = "Food environment",
"ses" = "SES",
"deprivation" = "Neighborhood deprivation"),
exposure = "pane",
outcome = "obesity"
)
ggdag_adjustment_set(obesity_dag, text = FALSE, use_labels = "label")
ggdag_paths(obesity_dag, text = FALSE, use_labels = "label")
ggdag(obesity_dag, text = FALSE, use_labels = "label")
ggdag_adjustment_set(obesity_dag, text = FALSE, use_labels = "label")+
theme(legend.position = "bottom")
### practice
obesity_dag <- dagify(obesity ~ pa + diet + genetic + age,
pa ~ pane + ses + genetic + deprivation + age,
diet ~ foodne + ses + genetic + deprivation + age,
pane ~ ses + age + deprivation,
foodne ~ ses,
labels = c("obesity" = "Obesity",
"pa" = "Physical activity",
"diet" = "Diet",
"genetic" = "Genetic risk",
"age" = "Age, Sex, Race",
"pane" = "PA environment",
"foodne" = "Food environment",
"ses" = "SES",
"deprivation" = "Neighborhood deprivation"),
exposure = "pane",
outcome = "obesity"
)
ggdag_adjustment_set(obesity_dag, text = FALSE, use_labels = "label")+
theme(legend.position = "bottom")
ggdag_adjustment_set(obesity_dag, text = FALSE, use_labels = "label")+
theme(legend.position = "bottom")
ggdag_adjustment_set(obesity_dag, text = FALSE, use_labels = "label")+
theme(legend.position = "bottom")
### practice
obesity_dag <- dagify(obesity ~ pa + diet + genetic + age,
pa ~ pane + ses + genetic + deprivation + age,
diet ~ foodne + ses + genetic + deprivation + age,
pane ~ ses + age + deprivation,
foodne ~ ses,
labels = c("obesity" = "Obesity",
"pa" = "Physical activity",
"diet" = "Diet",
"genetic" = "Genetic risk",
"age" = "Age, Sex, Race",
"pane" = "PA environment",
"foodne" = "Food environment",
"ses" = "SES",
"deprivation" = "Neighborhood deprivation"),
exposure = "pane",
outcome = "obesity") %>%
tidy_dagitty()
ggdag_adjustment_set(obesity_dag, text = FALSE, use_labels = "label")+
theme(legend.position = "bottom")
ggdag_adjustment_set(obesity_dag, node_size = 10 ,text = FALSE, use_labels = "label")+
theme(legend.position = "bottom")
ggdag_adjustment_set(obesity_dag, node_size = 20 ,text = FALSE, use_labels = "label")+
theme(legend.position = "bottom")
ggdag_adjustment_set(obesity_dag, node_size = 10 ,text = FALSE, use_labels = "label")+
theme(legend.position = "bottom")
ggdag_adjustment_set(obesity_dag, node_size = 15 ,text = FALSE, use_labels = "label")+
theme(legend.position = "bottom")
ggdag_adjustment_set(obesity_dag, node_size = 15 ,text = FALSE, use_labels = "label")+
theme(legend.position = "bottom")+
ggsave("graph/dag1.png")
obesity_dag2 <- dagify(obesity ~ pa + genetic + age,
pa ~ pane + ses + genetic + deprivation + age,
pane ~ ses + age + deprivation,
labels = c("obesity" = "Obesity",
"pa" = "Physical activity",
"genetic" = "Genetic risk",
"age" = "Age, Sex, Race",
"pane" = "PA environment",
"ses" = "SES",
"deprivation" = "Neighborhood deprivation"),
exposure = "pane",
outcome = "obesity") %>%
tidy_dagitty()
ggdag_adjustment_set(obesity_dag2, node_size = 15 ,text = FALSE, use_labels = "label")+
theme(legend.position = "bottom")+
ggsave("graph/dag2.png")
### DAG for food environment
obesity_dag1 <- dagify(obesity ~ diet + genetic + age,
diet ~ foodne + ses + genetic + deprivation + age,
foodne ~ ses + age + deprivation,
labels = c("obesity" = "Obesity",
"diet" = "Diet",
"genetic" = "Genetic risk",
"age" = "Age, Sex, Race",
"foodne" = "Food environment",
"ses" = "SES",
"deprivation" = "Neighborhood deprivation"),
exposure = "foodne",
outcome = "obesity") %>%
tidy_dagitty()
### DAG for food environment
obesity_dag3 <- dagify(obesity ~ diet + genetic + age,
diet ~ foodne + ses + genetic + deprivation + age,
foodne ~ ses + age + deprivation,
labels = c("obesity" = "Obesity",
"diet" = "Diet",
"genetic" = "Genetic risk",
"age" = "Age, Sex, Race",
"foodne" = "Food environment",
"ses" = "SES",
"deprivation" = "Neighborhood deprivation"),
exposure = "foodne",
outcome = "obesity") %>%
tidy_dagitty()
ggdag_adjustment_set(obesity_dag3, node_size = 15 ,text = FALSE, use_labels = "label")+
theme(legend.position = "bottom")+
ggsave("graph/dag3.png")
ggdag_adjustment_set(obesity_dag2, node_size = 15 ,text = FALSE, use_labels = "label")+
theme(legend.position = "bottom")+
ggsave("graph/dag2.png")
ggdag_adjustment_set(obesity_dag3, node_size = 15 ,text = FALSE, use_labels = "label")+
theme(legend.position = "bottom")+
ggsave("graph/dag3.png")
ggdag_adjustment_set(obesity_dag2, node_size = 15 ,text = FALSE, use_labels = "label")+
theme(legend.position = "bottom")+
ggsave("graph/dag2.png")
ggdag_adjustment_set(obesity_dag2, node_size = 15 ,text = FALSE, use_labels = "label")+
theme(legend.position = "bottom")+
ggsave("graph/dag2.png")
ggdag_adjustment_set(obesity_dag2, node_size = 15 ,text = FALSE, use_labels = "label")+
theme(legend.position = "bottom")+
ggsave("graph/dag2.png")
### DAG for food environment
obesity_dag3 <- dagify(obesity ~ diet + genetic + age,
diet ~ foodne + ses + genetic + deprivation + age,
foodne ~ ses + age + deprivation,
labels = c("obesity" = "Obesity",
"diet" = "Diet",
"genetic" = "Genetic risk",
"age" = "Age, Sex, Race",
"foodne" = "Food environment",
"ses" = "SES",
"deprivation" = "Neighborhood deprivation"),
exposure = "foodne",
outcome = "obesity") %>%
tidy_dagitty()
ggdag_adjustment_set(obesity_dag3, node_size = 15 ,text = FALSE, use_labels = "label")+
theme(legend.position = "bottom")+
ggsave("graph/dag3.png")
### DAG for food environment
obesity_dag3 <- dagify(obesity ~ diet + genetic + age,
diet ~ foodne + ses + genetic + deprivation + age,
foodne ~ ses + age + deprivation,
labels = c("obesity" = "Obesity",
"diet" = "Diet",
"genetic" = "Genetic risk",
"age" = "Age, Sex, Race",
"foodne" = "Food environment",
"ses" = "SES",
"deprivation" = "Neighborhood deprivation"),
exposure = "foodne",
outcome = "obesity") %>%
tidy_dagitty()
ggdag_adjustment_set(obesity_dag3, node_size = 15 ,text = FALSE, use_labels = "label")+
theme(legend.position = "bottom")+
ggsave("graph/dag3.png")
### DAG for food environment
obesity_dag3 <- dagify(obesity ~ diet + genetic + age,
diet ~ foodne + ses + genetic + deprivation + age,
foodne ~ ses + age + deprivation,
labels = c("obesity" = "Obesity",
"diet" = "Diet",
"genetic" = "Genetic risk",
"age" = "Age, Sex, Race",
"foodne" = "Food environment",
"ses" = "SES",
"deprivation" = "Neighborhood deprivation"),
exposure = "foodne",
outcome = "obesity") %>%
tidy_dagitty()
ggdag_adjustment_set(obesity_dag3, node_size = 15 ,text = FALSE, use_labels = "label")+
theme(legend.position = "bottom")+
ggsave("graph/dag3.png")
### DAG for physical activity environment
obesity_dag2 <- dagify(obesity ~ pa + genetic + age,
pa ~ pane + ses + genetic + deprivation + age,
pane ~ ses + age + deprivation,
labels = c("obesity" = "Obesity",
"pa" = "Physical activity",
"genetic" = "Genetic risk",
"age" = "Age, Sex, Race",
"pane" = "PA environment",
"ses" = "SES",
"deprivation" = "Neighborhood deprivation"),
exposure = "pane",
outcome = "obesity") %>%
tidy_dagitty()
ggdag_adjustment_set(obesity_dag2, node_size = 15 ,text = FALSE, use_labels = "label")+
theme(legend.position = "bottom")+
ggsave("graph/dag2.png")
### DAG for overall
obesity_dag1 <- dagify(obesity ~ pa + diet + genetic + age,
pa ~ pane + ses + genetic + deprivation + age,
diet ~ foodne + ses + genetic + deprivation + age,
pane ~ ses + age + deprivation,
foodne ~ ses,
labels = c("obesity" = "Obesity",
"pa" = "Physical activity",
"diet" = "Diet",
"genetic" = "Genetic risk",
"age" = "Age, Sex, Race",
"pane" = "PA environment",
"foodne" = "Food environment",
"ses" = "SES",
"deprivation" = "Neighborhood deprivation"),
exposure = "pane",
outcome = "obesity") %>%
tidy_dagitty()
ggdag(obesity_dag1, text = FALSE, use_labels = "label")+
theme(legend.position = "bottom")+
ggsave("graph/dag1.png")
